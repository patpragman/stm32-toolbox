#include "hal.h"
#include "app_pins.h"

/*
 * stm32-toolbox HAL quickstart:
 * - hal_clock_init(): sets the default system clock and 1 ms SysTick.
 * - hal_delay_ms(ms) or delay(ms): millisecond delays.
 * - app_pins_init(): configures pins from the GUI.
 * - app_pin_write/toggle/read(): drive mapped pins.
 *
 * Pin map:
{% for pin in pins %}
 *   {{ pin.enum_name }} -> P{{ pin.port }}{{ pin.pin }} ({{ pin.mode }})
{% endfor %}
 */

int main(void)
{
    hal_clock_init();
    app_pins_init();
    hal_uart_init({{ serial_baud }}U);
    hal_uart_write("stm32-toolbox boot\\r\\n");

    while (1)
    {
        app_pin_write({{ led_enum_name }}, true);
        hal_delay_ms(300);
        app_pin_write({{ led_enum_name }}, false);
        hal_delay_ms(300);
        hal_uart_write("tick\\r\\n");
    }
}
